<html>
    <head>
        <meta charset="utf-8">
        <meta http-eqiv="x-UA-Compaible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title></title>
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        <script src="js/jquery-3.4.1.min.js"></script>
        <script src="bootstrap/js/bootstrap.min.js"></script>
        <link rel="stylesheet" href="./style.css">
    </head>
    <body onload="drawEx();dSF();">
        <!---導覽列選項--->
        <nav class="navbar navbar-expand-sm bg-light">
            <img id="logo" src="./javalogo.png" alt="logo"><span>Java Function</span>
            <button class="navbar-toggler border-light bg-light" type="button" 
	          data-toggle="collapse" data-target="#navbarNavDropdown" 
	          aria-controls="navbarNavDropdown" aria-expanded="false" 
			  aria-label="Toggle navigation">
		        <span class="navbar-toggler-icon"></span>
	        </button>
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="./1-1(主頁)認識函數.html">概念</a></li>
                <li class="nav-item"><a class="nav-link" href="./2-1函式定義.html">定義</a></li>
                <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">呼叫</a>
                    <ul class="dropdown-menu"  aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="./3-1函式呼叫.html">函式呼叫</a></li>
                        <li><a class="dropdown-item" href="./3-2傳值呼叫與傳址呼叫.html">傳值呼叫與傳址呼叫</a></li>
                        <li><a class="dropdown-item" href="./3-3傳陣列.html">傳陣列呼叫</a></li>
                    </ul>
                </li>
                <li class="nav-item"><a class="nav-link" href="./4-1控制權的概念.html">控制權轉移</a></li>
                <li class="nav-item"><a class="nav-link" href="./5-1函式呼叫模擬.html">模擬</a></li>
                <li class="nav-item"><a class="nav-link" href="./6-1測驗.html">測驗</a></li>
            </ul>
            <!--導覽列的搜尋列-->
            <form class="navSearch">
                <input class="form-control mr-sm-2" type="search" placeholder="找不到東西的搜尋列" />
                <button><i class="fas fa-search" id="searchbutton"></i>Search</button>
            </form>
        </nav>

        <h1>控制權轉移</h1>
        <p>程式的控制權將會轉移到相對應的函式開頭處，然後執行函式中的程式碼。函式的程式碼執行完畢後，程式控制權將重新回到主程式碼（呼叫敘述）的<b>下一個敘述</b>，繼續往下執行。
            <br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我們以下列程式碼做舉例<br></p>
        <br>
        <canvas id="main" height=450 width=1100></canvas><br>
        <div>
            <h3>說明</h3>
            <ol>
                <div>
                    <li><p>在主程式執行到第一個System.out.print時，因為在靠近結尾時呼叫函式max，所以該行以及輸出End Function敘述則先push至堆疊段中。</p></li>
                    <canvas id="sf1"></canvas>
                </div>
                <div><li>由於呼叫函式max，傳入引數5、2和7，控制權移轉至max函式，且宣告一個叫large的區域變數。</li></div>
                <div><li>經過if-else判斷，num1&nbsp;>&nbsp;num2(即5>2)，所以執行條件為true的敘述。</li></div>
                <div><li>設定區域變數large為較大的num1，再和傳入的第三個引數比較。</li></div>
                <div><li>經過條件判斷結果為false，執行else所包含的敘述，且設定large為三個引數中最大的數。</li></div>
                <div><li>函式執行結束，回傳區域變數所存的值，並移轉控制權回原本呼叫的主程式且系統收回原本給large的記憶體空間。</li></div>
                <div><li>從堆疊框架中pop尚未執行的程式，得到以下最終執行結果。</li></div>
            </ol>
        </div>
        <img src="./控制權轉移-程式範例執行結果.png"><br>
        <p>輸出的The&nbsp;maxium&nbsp;of&nbsp;i,&nbsp;j&nbsp;and&nbsp;k&nbsp;是原先在Stack&nbsp;Frame最上面的程式，由於Stack是先進後出(或稱後進先出)，所以在框架最上方的會先執行，而堆在它下方的輸出End&nbsp;Function則緊接著執行。</p>
        
    </body>
    <script>
        
        function drawEx(){
            var ma=document.getElementById("main").getContext("2d");
            ma.font="15px sans-serif";
            
            {
                ma.beginPath();
                ma.fillText("public static void main(String args[]) {",20,60);
                ma.fillText("int i = 5 ;",30,80);
                ma.fillText("int j = 2 ;",30,95);
                ma.fillText("int k = 7 ;",30,110);
                ma.fillText('System.out.println("The maxium of"+i+","+j+"and"+k+"is"+max(i,j,k));',30,145);
                ma.fillText('System.out.println("End Function");',30,160);
                ma.fillText("}",20,180);
                ma.closePath();
            }

            {
                ma.beginPath();
                ma.fillText("public static int max(int num1, int num2,int num3) {",520,35);
                ma.fillText("int large ;",530,55);
                ma.fillText("if ( num1 > num2 ) {",530,85);
                ma.fillText("large = num1 ;",550,100);
                ma.fillText('System.out.println("The maxium of"+num1+"and"+num2+"is"+large);',550,115);
                ma.fillText('if ( num3 > large ) {',550,130);
                ma.fillText('System.out.println("The maxium of"+large+"and"+num3+"is"+num3);',570,145);
                ma.fillText('large = num3 ;',570,160);
                ma.fillText("}else{",550,175);
                ma.fillText('System.out.println("The maxium of"+large+"and"+num3+"is"+large);',570,190);
                ma.fillText("}",550,205);
                ma.fillText("else {",530,220);
                ma.fillText("large = num2 ;",550,235);
                ma.fillText('System.out.println("The Maxium of"+num1+"and"+num2+"is"+large);',550,250);
                ma.fillText("if(large > num3 ) {",550,265);
                ma.fillText('System.out.println("The maxium of"+large+"and"+num3+"is"+large);',570,280);
                ma.fillText("}else {",550,295);
                ma.fillText('System.out.println("The Maxium of "+large+"and"+num3+"is"+num3);',570,310);
                ma.fillText("large = num3;",570,325);
                ma.fillText("}",550,340);
                ma.fillText("}",530,355);
                ma.fillText("return large ;",530,370);
                ma.fillText("}",520,385);
                ma.closePath();
            }

            {   //外框
                ma.beginPath();
                ma.moveTo(510,15);
                ma.strokeStyle = "#c00";
                ma.lineTo(1050,15);
                ma.quadraticCurveTo(1060,15,1060,25);
                ma.lineTo(1060,400);
                ma.quadraticCurveTo(1060,410,1050,410);
                ma.lineTo(510,410);
                ma.quadraticCurveTo(500,410,500,400);
                ma.lineTo(500,200);
                ma.quadraticCurveTo(480,200,460,150);
                ma.quadraticCurveTo(490,200,500,160);
                ma.lineTo(500,20);
                ma.quadraticCurveTo(500,15,510,15);
                ma.stroke();
                ma.closePath();
            }
        }

        function dSF(){
            var ctx=document.getElementById("sf1").getContext("2d");
            ctx.font="15px sans-serif";
            ctx.beginPath();
            ctx.moveTo(20,50);
            ctx.lineTo(20,120);
            ctx.lineTo(270,120);
            ctx.lineTo(270,50);
            ctx.stroke();
            ctx.closePath();

            ctx.beginPath();
            ctx.moveTo(20,90);
            ctx.lineTo(270,90);
            ctx.fillText('System.out.println("End Function")',30,110);
            ctx.moveTo(20,60);
            ctx.lineTo(270,60);
            ctx.fillText('System.out.println(".."+max(i,j,k))',30,80);
            ctx.fillStyle="blue";
            ctx.fillText("Stack Frame",100,30);
            ctx.stroke();
            ctx.closePath();
        }

    </script>
</html>